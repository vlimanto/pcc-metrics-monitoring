---
apiVersion: v1
kind: Namespace
metadata:
  name: monitoring
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: grafana-pvc
  namespace: monitoring
spec:
  storageClassName: gp2
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards-provisioning
  namespace: monitoring
data:
  all_dash.yml: |
       apiVersion: 1
       
       providers:
         # <string> an unique provider name. Required
         - name: 'Grafana Dashboards'
           # <int> Org id. Default to 1
           orgId: 1
           # <string> name of the dashboard folder.
           folder: ''
           # <string> folder UID. will be automatically generated if not specified
           folderUid: ''
           # <string> provider type. Default to 'file'
           type: file
           # <bool> disable dashboard deletion
           disableDeletion: false
           # <int> how often Grafana will scan for changed dashboards
           updateIntervalSeconds: 10
           # <bool> allow updating provisioned dashboards from the UI
           allowUiUpdates: true
           options:
             # <string, required> path to dashboard files on disk. Required when using the 'file' type
             path: /var/lib/grafana/dashboards
             # <bool> use folder names from filesystem to create folders in Grafana
             foldersFromFilesStructure: true

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-datasources-provisioning
  namespace: monitoring
data:
  all_sources.yml: |
       apiVersion: 1
       
       datasources:
       - name: Prometheus
         type: prometheus
         access: proxy
         url: http://prometheus:9090
         isDefault: true
         version: 1
         editable: true

       - name: Loki
         type: loki
         access: proxy 
         orgId: 1
         url: http://loki:3100
         basicAuth: false
         isDefault: false
         version: 1
         editable: false

---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: grafana
  name: grafana
  namespace: monitoring
spec:
  selector:
    matchLabels:
      app: grafana
  template:
    metadata:
      labels:
        app: grafana
    spec:
      securityContext:
        fsGroup: 472
        supplementalGroups:
          - 0
      containers:
        - name: grafana
          image: grafana/grafana:latest
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 3000
              name: http-grafana
              protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /robots.txt
              port: 3000
              scheme: HTTP
            initialDelaySeconds: 10
            periodSeconds: 30
            successThreshold: 1
            timeoutSeconds: 2
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 10
            successThreshold: 1
            tcpSocket:
              port: 3000
            timeoutSeconds: 1
          resources:
            requests:
              cpu: 250m
              memory: 750Mi
          volumeMounts:
            - mountPath: /var/lib/grafana
              name: grafana-pv
            - name: grafana-dashboards-provisioning
              mountPath: /etc/grafana/provisioning/dashboards/
            - name: grafana-datasources-provisioning
              mountPath: /etc/grafana/provisioning/datasources/
            - name: grafana-dashboards
              mountPath: /var/lib/grafana/dashboards/Prisma-Cloud-Dashboards
          env:
            - name: GF_INSTALL_PLUGINS
              value: "grafana-piechart-panel, natel-plotly-panel, blackmirror1-singlestat-math-panel, btplc-trend-box-panel, marcuscalidus-svg-panel, michaeldmoore-multistat-panel, yesoreyeram-boomtable-panel, ryantxu-ajax-panel, grafana-influxdb-flux-datasource, fetzerch-sunandmoon-datasource, andig-darksky-datasource, simpod-json-datasource"

      volumes:
        - name: grafana-pv
          persistentVolumeClaim:
            claimName: grafana-pvc
        - name: grafana-dashboards-provisioning
          configMap:
            name: grafana-dashboards-provisioning
        - name: grafana-datasources-provisioning
          configMap:
            name: grafana-datasources-provisioning
        - name: grafana-dashboards
          configMap:
            name: grafana-dashboards
---
apiVersion: v1
kind: Service
metadata:
  name: grafana
  namespace: monitoring
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-scheme: internet-facing
spec:
  ports:
    - port: 3000
      protocol: TCP
      targetPort: http-grafana
  selector:
    app: grafana
  sessionAffinity: None
  type: LoadBalancer
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards
  namespace: monitoring
data:
  compute-counters.json: |
       
       {
           "annotations": {
             "list": [
               {
                 "builtIn": 1,
                 "datasource": "-- Grafana --",
                 "enable": true,
                 "hide": true,
                 "iconColor": "rgba(0, 211, 255, 1)",
                 "name": "Annotations & Alerts",
                 "type": "dashboard"
               }
             ]
           },
           "editable": true,
           "gnetId": null,
           "graphTooltip": 1,
           "id": 8,
           "links": [
             {
               "icon": "info",
               "tags": [],
               "targetBlank": true,
               "title": "Grafana Docs",
               "tooltip": "",
               "type": "link",
               "url": "http://docs.grafana.org/"
             },
             {
               "icon": "info",
               "tags": [],
               "targetBlank": true,
               "title": "Prometheus Docs",
               "type": "link",
               "url": "http://prometheus.io/docs/introduction/overview/"
             }
           ],
           "panels": [
             {
               "aliasColors": {},
               "bars": false,
               "cacheTimeout": null,
               "dashLength": 10,
               "dashes": false,
               "datasource": "Prometheus",
               "fill": 1,
               "fillGradient": 0,
               "gridPos": {
                 "h": 8,
                 "w": 12,
                 "x": 0,
                 "y": 0
               },
               "hiddenSeries": false,
               "id": 44,
               "legend": {
                 "avg": false,
                 "current": false,
                 "max": false,
                 "min": false,
                 "show": true,
                 "total": false,
                 "values": false
               },
               "lines": true,
               "linewidth": 1,
               "links": [],
               "nullPointMode": "null",
               "options": {
                 "dataLinks": []
               },
               "percentage": false,
               "pluginVersion": "6.5.1",
               "pointradius": 2,
               "points": true,
               "renderer": "flot",
               "seriesOverrides": [],
               "spaceLength": 10,
               "stack": false,
               "steppedLine": false,
               "targets": [
                 {
                   "expr": "sum(irate(twistlock_api_requests{job=\"twistlock\"}[1m]))",
                   "format": "time_series",
                   "hide": false,
                   "instant": false,
                   "intervalFactor": 2,
                   "legendFormat": "api_requests",
                   "refId": "A"
                 }
               ],
               "thresholds": [],
               "timeFrom": null,
               "timeRegions": [],
               "timeShift": null,
               "title": "API Requests to Console",
               "tooltip": {
                 "shared": true,
                 "sort": 0,
                 "value_type": "individual"
               },
               "type": "graph",
               "xaxis": {
                 "buckets": null,
                 "mode": "time",
                 "name": null,
                 "show": true,
                 "values": []
               },
               "yaxes": [
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 },
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 }
               ],
               "yaxis": {
                 "align": false,
                 "alignLevel": null
               }
             },
             {
               "aliasColors": {},
               "bars": false,
               "cacheTimeout": null,
               "dashLength": 10,
               "dashes": false,
               "datasource": "Prometheus",
               "fill": 1,
               "fillGradient": 0,
               "gridPos": {
                 "h": 8,
                 "w": 12,
                 "x": 12,
                 "y": 0
               },
               "hiddenSeries": false,
               "id": 46,
               "legend": {
                 "avg": false,
                 "current": false,
                 "max": false,
                 "min": false,
                 "show": true,
                 "total": false,
                 "values": false
               },
               "lines": true,
               "linewidth": 1,
               "links": [],
               "nullPointMode": "null",
               "options": {
                 "dataLinks": []
               },
               "percentage": false,
               "pluginVersion": "6.5.1",
               "pointradius": 2,
               "points": true,
               "renderer": "flot",
               "seriesOverrides": [],
               "spaceLength": 10,
               "stack": false,
               "steppedLine": false,
               "targets": [
                 {
                   "expr": "twistlock_api_requests{job=\"twistlock\"}",
                   "format": "time_series",
                   "hide": false,
                   "instant": false,
                   "intervalFactor": 2,
                   "legendFormat": "api_requests",
                   "refId": "A"
                 }
               ],
               "thresholds": [],
               "timeFrom": null,
               "timeRegions": [],
               "timeShift": null,
               "title": "Total API Requests to Console",
               "tooltip": {
                 "shared": true,
                 "sort": 0,
                 "value_type": "individual"
               },
               "type": "graph",
               "xaxis": {
                 "buckets": null,
                 "mode": "time",
                 "name": null,
                 "show": true,
                 "values": []
               },
               "yaxes": [
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 },
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 }
               ],
               "yaxis": {
                 "align": false,
                 "alignLevel": null
               }
             },
             {
               "aliasColors": {},
               "bars": false,
               "cacheTimeout": null,
               "dashLength": 10,
               "dashes": false,
               "datasource": "Prometheus",
               "fill": 1,
               "fillGradient": 0,
               "gridPos": {
                 "h": 8,
                 "w": 12,
                 "x": 0,
                 "y": 8
               },
               "hiddenSeries": false,
               "id": 45,
               "interval": "",
               "legend": {
                 "avg": false,
                 "current": false,
                 "max": false,
                 "min": false,
                 "show": true,
                 "total": false,
                 "values": false
               },
               "lines": true,
               "linewidth": 1,
               "links": [],
               "nullPointMode": "null",
               "options": {
                 "dataLinks": []
               },
               "percentage": false,
               "pluginVersion": "6.5.1",
               "pointradius": 2,
               "points": true,
               "renderer": "flot",
               "seriesOverrides": [],
               "spaceLength": 10,
               "stack": false,
               "steppedLine": false,
               "targets": [
                 {
                   "expr": "sum(irate(twistlock_defender_events{job=\"twistlock\"}[1m]))",
                   "format": "time_series",
                   "hide": false,
                   "instant": false,
                   "interval": "",
                   "intervalFactor": 2,
                   "legendFormat": "defender_events",
                   "refId": "A"
                 }
               ],
               "thresholds": [],
               "timeFrom": null,
               "timeRegions": [],
               "timeShift": null,
               "title": "Defender Events",
               "tooltip": {
                 "shared": true,
                 "sort": 0,
                 "value_type": "individual"
               },
               "type": "graph",
               "xaxis": {
                 "buckets": null,
                 "mode": "time",
                 "name": null,
                 "show": true,
                 "values": []
               },
               "yaxes": [
                 {
                   "decimals": null,
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 },
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 }
               ],
               "yaxis": {
                 "align": false,
                 "alignLevel": null
               }
             },
             {
               "aliasColors": {},
               "bars": false,
               "cacheTimeout": null,
               "dashLength": 10,
               "dashes": false,
               "datasource": "Prometheus",
               "fill": 1,
               "fillGradient": 0,
               "gridPos": {
                 "h": 8,
                 "w": 12,
                 "x": 12,
                 "y": 8
               },
               "hiddenSeries": false,
               "id": 47,
               "legend": {
                 "avg": false,
                 "current": false,
                 "max": false,
                 "min": false,
                 "show": true,
                 "total": false,
                 "values": false
               },
               "lines": true,
               "linewidth": 1,
               "links": [],
               "nullPointMode": "null",
               "options": {
                 "dataLinks": []
               },
               "percentage": false,
               "pluginVersion": "6.5.1",
               "pointradius": 2,
               "points": true,
               "renderer": "flot",
               "seriesOverrides": [],
               "spaceLength": 10,
               "stack": false,
               "steppedLine": false,
               "targets": [
                 {
                   "expr": "twistlock_defender_events{job=\"twistlock\"}",
                   "format": "time_series",
                   "hide": false,
                   "instant": false,
                   "intervalFactor": 2,
                   "legendFormat": "defender_events",
                   "refId": "A"
                 }
               ],
               "thresholds": [],
               "timeFrom": null,
               "timeRegions": [],
               "timeShift": null,
               "title": "Defender Events",
               "tooltip": {
                 "shared": true,
                 "sort": 0,
                 "value_type": "individual"
               },
               "type": "graph",
               "xaxis": {
                 "buckets": null,
                 "mode": "time",
                 "name": null,
                 "show": true,
                 "values": []
               },
               "yaxes": [
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 },
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 }
               ],
               "yaxis": {
                 "align": false,
                 "alignLevel": null
               }
             }
           ],
           "refresh": "1m",
           "revision": "1.0",
           "schemaVersion": 21,
           "style": "dark",
           "tags": [],
           "templating": {
             "list": []
           },
           "time": {
             "from": "now-1h",
             "to": "now"
           },
           "timepicker": {
             "now": true,
             "refresh_intervals": [
               "5s",
               "10s",
               "30s",
               "1m",
               "5m",
               "15m",
               "30m",
               "1h",
               "2h",
               "1d"
             ],
             "time_options": [
               "5m",
               "15m",
               "1h",
               "6h",
               "12h",
               "24h",
               "2d",
               "7d",
               "30d"
             ]
           },
           "timezone": "browser",
           "title": "Compute Prometheus Counters",
           "uid": "BTYTLOQnk",
           "version": 18
         }

  compute-gauge.json: |
       {
           "annotations": {
             "list": [
               {
                 "builtIn": 1,
                 "datasource": "-- Grafana --",
                 "enable": true,
                 "hide": true,
                 "iconColor": "rgba(0, 211, 255, 1)",
                 "name": "Annotations & Alerts",
                 "type": "dashboard"
               }
             ]
           },
           "editable": true,
           "gnetId": null,
           "graphTooltip": 1,
           "id": 10,
           "links": [
             {
               "icon": "info",
               "tags": [],
               "targetBlank": true,
               "title": "Grafana Docs",
               "tooltip": "",
               "type": "link",
               "url": "http://docs.grafana.org/"
             },
             {
               "icon": "info",
               "tags": [],
               "targetBlank": true,
               "title": "Prometheus Docs",
               "type": "link",
               "url": "http://prometheus.io/docs/introduction/overview/"
             }
           ],
           "panels": [
             {
               "aliasColors": {},
               "bars": false,
               "dashLength": 10,
               "dashes": false,
               "datasource": "Prometheus",
               "fill": 1,
               "fillGradient": 0,
               "gridPos": {
                 "h": 6,
                 "w": 8,
                 "x": 0,
                 "y": 0
               },
               "hiddenSeries": false,
               "id": 51,
               "legend": {
                 "avg": false,
                 "current": false,
                 "max": false,
                 "min": false,
                 "show": true,
                 "total": false,
                 "values": false
               },
               "lines": true,
               "linewidth": 1,
               "nullPointMode": "null",
               "options": {
                 "dataLinks": []
               },
               "percentage": false,
               "pointradius": 2,
               "points": true,
               "renderer": "flot",
               "seriesOverrides": [],
               "spaceLength": 10,
               "stack": false,
               "steppedLine": false,
               "targets": [
                 {
                   "expr": "twistlock_protected_containers",
                   "format": "time_series",
                   "instant": false,
                   "intervalFactor": 2,
                   "legendFormat": "protected_containers",
                   "refId": "A"
                 }
               ],
               "thresholds": [],
               "timeFrom": null,
               "timeRegions": [],
               "timeShift": null,
               "title": "Protected Containers",
               "tooltip": {
                 "shared": true,
                 "sort": 0,
                 "value_type": "individual"
               },
               "type": "graph",
               "xaxis": {
                 "buckets": null,
                 "mode": "time",
                 "name": null,
                 "show": true,
                 "values": []
               },
               "yaxes": [
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 },
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 }
               ],
               "yaxis": {
                 "align": false,
                 "alignLevel": null
               }
             },
             {
               "aliasColors": {},
               "bars": false,
               "dashLength": 10,
               "dashes": false,
               "datasource": "Prometheus",
               "fill": 1,
               "fillGradient": 0,
               "gridPos": {
                 "h": 6,
                 "w": 8,
                 "x": 8,
                 "y": 0
               },
               "hiddenSeries": false,
               "id": 41,
               "legend": {
                 "avg": false,
                 "current": false,
                 "max": false,
                 "min": false,
                 "show": true,
                 "total": false,
                 "values": false
               },
               "lines": true,
               "linewidth": 1,
               "nullPointMode": "null",
               "options": {
                 "dataLinks": []
               },
               "percentage": false,
               "pointradius": 2,
               "points": false,
               "renderer": "flot",
               "seriesOverrides": [],
               "spaceLength": 10,
               "stack": false,
               "steppedLine": false,
               "targets": [
                 {
                   "expr": "twistlock_active_defenders{job=\"twistlock\"}",
                   "legendFormat": "active_defenders",
                   "refId": "A"
                 }
               ],
               "thresholds": [],
               "timeFrom": null,
               "timeRegions": [],
               "timeShift": null,
               "title": "Active Defenders",
               "tooltip": {
                 "shared": true,
                 "sort": 0,
                 "value_type": "individual"
               },
               "type": "graph",
               "xaxis": {
                 "buckets": null,
                 "mode": "time",
                 "name": null,
                 "show": true,
                 "values": []
               },
               "yaxes": [
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 },
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 }
               ],
               "yaxis": {
                 "align": false,
                 "alignLevel": null
               }
             },
             {
               "aliasColors": {},
               "bars": false,
               "dashLength": 10,
               "dashes": false,
               "datasource": "Prometheus",
               "fill": 1,
               "fillGradient": 0,
               "gridPos": {
                 "h": 6,
                 "w": 8,
                 "x": 16,
                 "y": 0
               },
               "hiddenSeries": false,
               "id": 42,
               "legend": {
                 "avg": false,
                 "current": false,
                 "max": false,
                 "min": false,
                 "show": true,
                 "total": false,
                 "values": false
               },
               "lines": true,
               "linewidth": 1,
               "nullPointMode": "null",
               "options": {
                 "dataLinks": []
               },
               "percentage": false,
               "pointradius": 2,
               "points": false,
               "renderer": "flot",
               "seriesOverrides": [],
               "spaceLength": 10,
               "stack": false,
               "steppedLine": false,
               "targets": [
                 {
                   "expr": "twistlock_total_defenders{job=\"twistlock\"}",
                   "legendFormat": "total_defenders",
                   "refId": "A"
                 }
               ],
               "thresholds": [],
               "timeFrom": null,
               "timeRegions": [],
               "timeShift": null,
               "title": "Total Defenders",
               "tooltip": {
                 "shared": true,
                 "sort": 0,
                 "value_type": "individual"
               },
               "type": "graph",
               "xaxis": {
                 "buckets": null,
                 "mode": "time",
                 "name": null,
                 "show": true,
                 "values": []
               },
               "yaxes": [
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 },
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 }
               ],
               "yaxis": {
                 "align": false,
                 "alignLevel": null
               }
             },
             {
               "aliasColors": {
                 "critical_vulns": "#C4162A",
                 "high_vulns": "#FF780A",
                 "low_vulns": "#56A64B",
                 "medium_vulns": "#FFEE52"
               },
               "breakPoint": "50%",
               "cacheTimeout": null,
               "combine": {
                 "label": "Others",
                 "threshold": 0
               },
               "datasource": "Prometheus",
               "fontSize": "80%",
               "format": "short",
               "gridPos": {
                 "h": 6,
                 "w": 6,
                 "x": 0,
                 "y": 6
               },
               "id": 44,
               "interval": null,
               "legend": {
                 "percentage": true,
                 "show": true,
                 "values": true
               },
               "legendType": "Right side",
               "links": [],
               "nullPointMode": "connected",
               "options": {},
               "pieType": "pie",
               "pluginVersion": "6.5.1",
               "strokeWidth": ".5",
               "targets": [
                 {
                   "expr": "twistlock_images_critical_vulnerabilities{job=\"twistlock\"}",
                   "intervalFactor": 1,
                   "legendFormat": "critical_vulns",
                   "refId": "A"
                 },
                 {
                   "expr": "twistlock_images_high_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "high_vulns",
                   "refId": "B"
                 },
                 {
                   "expr": "twistlock_images_critical_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "medium_vulns",
                   "refId": "C"
                 },
                 {
                   "expr": "twistlock_images_low_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "low_vulns",
                   "refId": "D"
                 }
               ],
               "timeFrom": null,
               "timeShift": null,
               "title": "Image Vulnerabilities",
               "type": "grafana-piechart-panel",
               "valueName": "current"
             },
             {
               "aliasColors": {
                 "critical_vulns": "#C4162A",
                 "high_vulns": "#FF780A",
                 "low_vulns": "#56A64B",
                 "medium_vulns": "#FFEE52"
               },
               "breakPoint": "50%",
               "cacheTimeout": null,
               "combine": {
                 "label": "Others",
                 "threshold": 0
               },
               "datasource": "Prometheus",
               "fontSize": "80%",
               "format": "short",
               "gridPos": {
                 "h": 6,
                 "w": 6,
                 "x": 6,
                 "y": 6
               },
               "id": 45,
               "interval": null,
               "legend": {
                 "percentage": true,
                 "show": true,
                 "values": true
               },
               "legendType": "Right side",
               "links": [],
               "nullPointMode": "connected",
               "options": {},
               "pieType": "pie",
               "pluginVersion": "6.5.1",
               "strokeWidth": ".5",
               "targets": [
                 {
                   "expr": "twistlock_hosts_critical_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "critical_vulns",
                   "refId": "A"
                 },
                 {
                   "expr": "twistlock_hosts_high_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "high_vulns",
                   "refId": "B"
                 },
                 {
                   "expr": "twistlock_hosts_critical_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "medium_vulns",
                   "refId": "C"
                 },
                 {
                   "expr": "twistlock_hosts_low_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "low_vulns",
                   "refId": "D"
                 }
               ],
               "timeFrom": null,
               "timeShift": null,
               "title": "Host Vulnerabilities",
               "type": "grafana-piechart-panel",
               "valueName": "current"
             },
             {
               "aliasColors": {
                 "critical_vulns": "#C4162A",
                 "high_vulns": "#FF780A",
                 "low_vulns": "#56A64B",
                 "medium_vulns": "#FFEE52"
               },
               "breakPoint": "50%",
               "cacheTimeout": null,
               "combine": {
                 "label": "Others",
                 "threshold": 0
               },
               "datasource": "Prometheus",
               "fontSize": "80%",
               "format": "short",
               "gridPos": {
                 "h": 6,
                 "w": 6,
                 "x": 12,
                 "y": 6
               },
               "id": 46,
               "interval": null,
               "legend": {
                 "percentage": true,
                 "show": true,
                 "values": true
               },
               "legendType": "Right side",
               "links": [],
               "nullPointMode": "connected",
               "options": {},
               "pieType": "pie",
               "pluginVersion": "6.5.1",
               "strokeWidth": ".5",
               "targets": [
                 {
                   "expr": "twistlock_serverless_critical_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "critical_vulns",
                   "refId": "A"
                 },
                 {
                   "expr": "twistlock_serverless_high_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "high_vulns",
                   "refId": "B"
                 },
                 {
                   "expr": "twistlock_serverless_critical_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "medium_vulns",
                   "refId": "C"
                 },
                 {
                   "expr": "twistlock_serverless_low_vulnerabilities{job=\"twistlock\"}",
                   "legendFormat": "low_vulns",
                   "refId": "D"
                 }
               ],
               "timeFrom": null,
               "timeShift": null,
               "title": "Serverless Vulnerabilities",
               "type": "grafana-piechart-panel",
               "valueName": "current"
             },
             {
               "aliasColors": {},
               "bars": false,
               "dashLength": 10,
               "dashes": false,
               "datasource": "Prometheus",
               "fill": 1,
               "fillGradient": 0,
               "gridPos": {
                 "h": 6,
                 "w": 6,
                 "x": 18,
                 "y": 6
               },
               "hiddenSeries": false,
               "id": 48,
               "legend": {
                 "avg": false,
                 "current": false,
                 "max": false,
                 "min": false,
                 "show": true,
                 "total": false,
                 "values": false
               },
               "lines": true,
               "linewidth": 1,
               "nullPointMode": "null",
               "options": {
                 "dataLinks": []
               },
               "percentage": false,
               "pointradius": 2,
               "points": false,
               "renderer": "flot",
               "seriesOverrides": [],
               "spaceLength": 10,
               "stack": false,
               "steppedLine": false,
               "targets": [
                 {
                   "expr": "sum(irate(twistlock_container_app_firewall_events{job=\"twistlock\"}[5m]))",
                   "legendFormat": "container_waas_events",
                   "refId": "A"
                 },
                 {
                   "expr": "sum(irate(twistlock_host_app_firewall_events{job=\"twistlock\"}[5m]))",
                   "legendFormat": "host_waas_events",
                   "refId": "B"
                 }
               ],
               "thresholds": [],
               "timeFrom": null,
               "timeRegions": [],
               "timeShift": null,
               "title": "WAAS Events",
               "tooltip": {
                 "shared": true,
                 "sort": 0,
                 "value_type": "individual"
               },
               "type": "graph",
               "xaxis": {
                 "buckets": null,
                 "mode": "time",
                 "name": null,
                 "show": true,
                 "values": []
               },
               "yaxes": [
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 },
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 }
               ],
               "yaxis": {
                 "align": false,
                 "alignLevel": null
               }
             },
             {
               "aliasColors": {
                 "critical_compliance": "#C4162A",
                 "critical_vulns": "#C4162A",
                 "high_compliance": "#FF780A",
                 "high_vulns": "#FF780A",
                 "low_compliance": "#96D98D",
                 "low_vulns": "#56A64B",
                 "medium_compliance": "#FFEE52",
                 "medium_vulns": "#FFEE52"
               },
               "breakPoint": "50%",
               "cacheTimeout": null,
               "combine": {
                 "label": "Others",
                 "threshold": 0
               },
               "datasource": "Prometheus",
               "fontSize": "80%",
               "format": "short",
               "gridPos": {
                 "h": 6,
                 "w": 7,
                 "x": 0,
                 "y": 12
               },
               "id": 47,
               "interval": null,
               "legend": {
                 "percentage": true,
                 "show": true,
                 "values": true
               },
               "legendType": "Right side",
               "links": [],
               "nullPointMode": "connected",
               "options": {},
               "pieType": "pie",
               "pluginVersion": "6.5.1",
               "strokeWidth": ".5",
               "targets": [
                 {
                   "expr": "twistlock_critical_compliance{job=\"twistlock\"}",
                   "intervalFactor": 1,
                   "legendFormat": "critical_compliance",
                   "refId": "A"
                 },
                 {
                   "expr": "twistlock_high_compliance{job=\"twistlock\"}",
                   "legendFormat": "high_compliance",
                   "refId": "B"
                 },
                 {
                   "expr": "twistlock_critical_compliance{job=\"twistlock\"}",
                   "legendFormat": "medium_compliance",
                   "refId": "C"
                 },
                 {
                   "expr": "twistlock_low_compliance{job=\"twistlock\"}",
                   "legendFormat": "low_compliance",
                   "refId": "D"
                 }
               ],
               "timeFrom": null,
               "timeShift": null,
               "title": "Resource Compliance",
               "type": "grafana-piechart-panel",
               "valueName": "current"
             },
             {
               "aliasColors": {},
               "bars": false,
               "dashLength": 10,
               "dashes": false,
               "datasource": "Prometheus",
               "fill": 1,
               "fillGradient": 0,
               "gridPos": {
                 "h": 6,
                 "w": 6,
                 "x": 7,
                 "y": 12
               },
               "hiddenSeries": false,
               "id": 53,
               "legend": {
                 "avg": false,
                 "current": false,
                 "max": false,
                 "min": false,
                 "show": true,
                 "total": false,
                 "values": false
               },
               "lines": true,
               "linewidth": 1,
               "nullPointMode": "null",
               "options": {
                 "dataLinks": []
               },
               "percentage": false,
               "pointradius": 2,
               "points": false,
               "renderer": "flot",
               "seriesOverrides": [],
               "spaceLength": 10,
               "stack": false,
               "steppedLine": false,
               "targets": [
                 {
                   "expr": "twistlock_access_events{job=\"twistlock\"}",
                   "legendFormat": "access_events",
                   "refId": "A"
                 }
               ],
               "thresholds": [],
               "timeFrom": null,
               "timeRegions": [],
               "timeShift": null,
               "title": "Access Events",
               "tooltip": {
                 "shared": true,
                 "sort": 0,
                 "value_type": "individual"
               },
               "type": "graph",
               "xaxis": {
                 "buckets": null,
                 "mode": "time",
                 "name": null,
                 "show": true,
                 "values": []
               },
               "yaxes": [
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 },
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 }
               ],
               "yaxis": {
                 "align": false,
                 "alignLevel": null
               }
             },
             {
               "aliasColors": {},
               "bars": false,
               "dashLength": 10,
               "dashes": false,
               "datasource": "Prometheus",
               "fill": 1,
               "fillGradient": 0,
               "gridPos": {
                 "h": 6,
                 "w": 8,
                 "x": 13,
                 "y": 12
               },
               "hiddenSeries": false,
               "id": 52,
               "legend": {
                 "avg": false,
                 "current": false,
                 "max": false,
                 "min": false,
                 "show": true,
                 "total": false,
                 "values": false
               },
               "lines": true,
               "linewidth": 1,
               "nullPointMode": "null",
               "options": {
                 "dataLinks": []
               },
               "percentage": false,
               "pointradius": 2,
               "points": false,
               "renderer": "flot",
               "seriesOverrides": [],
               "spaceLength": 10,
               "stack": false,
               "steppedLine": false,
               "targets": [
                 {
                   "expr": "twistlock_container_runtime_events{job=\"twistlock\"}",
                   "legendFormat": "container_runtime",
                   "refId": "A"
                 },
                 {
                   "expr": "twistlock_host_runtime_events{job=\"twistlock\"}",
                   "legendFormat": "host_runtime",
                   "refId": "B"
                 }
               ],
               "thresholds": [],
               "timeFrom": null,
               "timeRegions": [],
               "timeShift": null,
               "title": "Runtime Events",
               "tooltip": {
                 "shared": true,
                 "sort": 0,
                 "value_type": "individual"
               },
               "type": "graph",
               "xaxis": {
                 "buckets": null,
                 "mode": "time",
                 "name": null,
                 "show": true,
                 "values": []
               },
               "yaxes": [
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 },
                 {
                   "format": "short",
                   "label": null,
                   "logBase": 1,
                   "max": null,
                   "min": null,
                   "show": true
                 }
               ],
               "yaxis": {
                 "align": false,
                 "alignLevel": null
               }
             },
             {
               "cacheTimeout": null,
               "colorBackground": false,
               "colorValue": false,
               "colors": [
                 "#299c46",
                 "rgba(237, 129, 40, 0.89)",
                 "#d44a3a"
               ],
               "datasource": "Prometheus",
               "format": "none",
               "gauge": {
                 "maxValue": 100,
                 "minValue": 0,
                 "show": false,
                 "thresholdLabels": false,
                 "thresholdMarkers": true
               },
               "gridPos": {
                 "h": 3,
                 "w": 3,
                 "x": 21,
                 "y": 12
               },
               "id": 49,
               "interval": null,
               "links": [],
               "mappingType": 1,
               "mappingTypes": [
                 {
                   "name": "value to text",
                   "value": 1
                 },
                 {
                   "name": "range to text",
                   "value": 2
                 }
               ],
               "maxDataPoints": 100,
               "nullPointMode": "connected",
               "nullText": null,
               "options": {},
               "pluginVersion": "6.5.1",
               "postfix": "",
               "postfixFontSize": "50%",
               "prefix": "",
               "prefixFontSize": "50%",
               "rangeMaps": [
                 {
                   "from": "null",
                   "text": "N/A",
                   "to": "null"
                 }
               ],
               "sparkline": {
                 "fillColor": "rgba(31, 118, 189, 0.18)",
                 "full": false,
                 "lineColor": "rgb(31, 120, 193)",
                 "show": false,
                 "ymax": null,
                 "ymin": null
               },
               "tableColumn": "",
               "targets": [
                 {
                   "expr": "twistlock_container_app_firewalls{job=\"twistlock\"}",
                   "legendFormat": "container_waas",
                   "refId": "B"
                 }
               ],
               "thresholds": "",
               "timeFrom": null,
               "timeShift": null,
               "title": "WAAS Containers",
               "type": "singlestat",
               "valueFontSize": "80%",
               "valueMaps": [
                 {
                   "op": "=",
                   "text": "N/A",
                   "value": "null"
                 }
               ],
               "valueName": "current"
             },
             {
               "cacheTimeout": null,
               "colorBackground": false,
               "colorValue": false,
               "colors": [
                 "#299c46",
                 "rgba(237, 129, 40, 0.89)",
                 "#d44a3a"
               ],
               "datasource": "Prometheus",
               "format": "none",
               "gauge": {
                 "maxValue": 100,
                 "minValue": 0,
                 "show": false,
                 "thresholdLabels": false,
                 "thresholdMarkers": true
               },
               "gridPos": {
                 "h": 3,
                 "w": 3,
                 "x": 21,
                 "y": 15
               },
               "id": 50,
               "interval": null,
               "links": [],
               "mappingType": 1,
               "mappingTypes": [
                 {
                   "name": "value to text",
                   "value": 1
                 },
                 {
                   "name": "range to text",
                   "value": 2
                 }
               ],
               "maxDataPoints": 100,
               "nullPointMode": "connected",
               "nullText": null,
               "options": {},
               "pluginVersion": "6.5.1",
               "postfix": "",
               "postfixFontSize": "50%",
               "prefix": "",
               "prefixFontSize": "50%",
               "rangeMaps": [
                 {
                   "from": "null",
                   "text": "N/A",
                   "to": "null"
                 }
               ],
               "sparkline": {
                 "fillColor": "rgba(31, 118, 189, 0.18)",
                 "full": false,
                 "lineColor": "rgb(31, 120, 193)",
                 "show": false,
                 "ymax": null,
                 "ymin": null
               },
               "tableColumn": "",
               "targets": [
                 {
                   "expr": "twistlock_host_app_firewalls{job=\"twistlock\"}",
                   "legendFormat": "host_waas",
                   "refId": "B"
                 }
               ],
               "thresholds": "",
               "timeFrom": null,
               "timeShift": null,
               "title": "WAAS Hosts",
               "type": "singlestat",
               "valueFontSize": "80%",
               "valueMaps": [
                 {
                   "op": "=",
                   "text": "N/A",
                   "value": "null"
                 }
               ],
               "valueName": "current"
             }
           ],
           "refresh": "1m",
           "revision": "1.0",
           "schemaVersion": 21,
           "style": "dark",
           "tags": [],
           "templating": {
             "list": []
           },
           "time": {
             "from": "now-1h",
             "to": "now"
           },
           "timepicker": {
             "now": true,
             "refresh_intervals": [
               "5s",
               "10s",
               "30s",
               "1m",
               "5m",
               "15m",
               "30m",
               "1h",
               "2h",
               "1d"
             ],
             "time_options": [
               "5m",
               "15m",
               "1h",
               "6h",
               "12h",
               "24h",
               "2d",
               "7d",
               "30d"
             ]
           },
           "timezone": "browser",
           "title": "Compute Prometheus Gauge",
           "uid": "MRlwEOQnk",
           "version": 13
         }
